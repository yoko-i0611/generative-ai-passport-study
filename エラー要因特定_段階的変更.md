# エラー要因特定：段階的変更

**作成日**: 2025-01-03  
**状態**: 古い構造（ad26bbb、288行）に戻しました

---

## 📋 現在の状態

### 古い構造（ad26bbbコミット）
- `app/courses/chapter1/page.tsx` - 288行
- `HybridContentCard`や`UnitQuizModal`を使用していない
- `ReactMarkdown`を使用したシンプルな構造

### 確認済みのファイル
- ✅ `HybridContentCard.tsx`が存在する
- ✅ `UnitQuizModal.tsx`が存在する
- ✅ `app/lib/unitQuizzes.ts`が存在する
- ✅ `public/unit_quizzes_all.json`が存在する

---

## 🔄 段階的な変更とエラー確認

### Phase 1: インポートの追加

**変更内容**:
```typescript
import HybridContentCard from '../../components/HybridContentCard';
import UnitQuizModal from '../../components/UnitQuizModal';
import { loadUnitQuizzes, getUnitQuizzesByChapter, getUnitQuizBySectionId } from '../../lib/unitQuizzes';
```

**確認**: ビルドエラーがないか

---

### Phase 2: useEffectの追加

**変更内容**:
```typescript
import { useState, useEffect } from 'react';

// ...
useEffect(() => {
  // 何もしない（空のuseEffect）
}, []);
```

**確認**: ビルドエラーがないか

---

### Phase 3: newChapter1Sectionsの定義

**変更内容**:
```typescript
const newChapter1Sections = [
  {
    id: 'unit01-ai-definition-history',
    title: 'AIの定義と歴史',
    // ...
  },
];
```

**確認**: ビルドエラーがないか

---

### Phase 4: loadUnitQuizzesの呼び出し

**変更内容**:
```typescript
useEffect(() => {
  const loadQuizzes = async () => {
    try {
      const allUnitQuizzes = await loadUnitQuizzes();
      console.log('確認テスト:', allUnitQuizzes);
    } catch (error) {
      console.error('エラー:', error);
    }
  };
  loadQuizzes();
}, []);
```

**確認**: ビルドエラーがないか、実行時エラーがないか

---

### Phase 5: HybridContentCardの使用

**変更内容**:
```typescript
{newChapter1Sections.map((section) => (
  <HybridContentCard
    key={section.id}
    title={section.title}
    keyPoints={section.cardDisplay.keyPoints}
  />
))}
```

**確認**: ビルドエラーがないか、実行時エラーがないか

---

## 🔍 エラー要因の特定

各Phaseでエラーが発生した場合、以下を確認：

1. **インポートパスの問題**
   - 相対パスが正しいか
   - ファイルが存在するか

2. **型定義の問題**
   - 型が正しく定義されているか
   - 型のインポートが正しいか

3. **データファイルの読み込み**
   - `public/unit_quizzes_all.json`が存在するか
   - パスが正しいか

4. **Next.jsの設定**
   - `tsconfig.json`の設定
   - `next.config.mjs`の設定

---

**最終更新**: 2025-01-03  
**次のステップ**: Phase 1から順番に変更してエラーを確認


