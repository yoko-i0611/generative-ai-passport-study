# エラー要因特定の手順

**作成日**: 2025-01-03  
**目的**: 古い構造から新しい構造に変更した時にエラーが出る要因を特定する

---

## 📋 現在の状態

### Gitの最新コミット（5b65389）
- `app/courses/chapter1/page.tsx` - 752行（新しい構造）
- `HybridContentCard`と`UnitQuizModal`を使用
- `newChapter1Sections`が定義されている

### 確認事項
- ✅ `HybridContentCard.tsx`が存在する（Gitで管理されている）
- ✅ `UnitQuizModal.tsx`が存在する
- ✅ `app/lib/unitQuizzes.ts`が存在する
- ✅ `public/unit_quizzes_all.json`が存在する

---

## 🔄 手順

### ステップ1: 古い構造に戻す

```bash
# Gitの最新コミットの状態を確認
git checkout HEAD -- app/courses/chapter1/page.tsx
```

### ステップ2: 古い構造の確認

- `app/courses/chapter1/page.tsx`の行数を確認
- `HybridContentCard`や`UnitQuizModal`を使用していないことを確認
- シンプルな構造であることを確認

### ステップ3: 新しい構造に段階的に変更

#### Phase 1: インポートの追加
```typescript
import HybridContentCard from '../../components/HybridContentCard';
import UnitQuizModal from '../../components/UnitQuizModal';
import { loadUnitQuizzes, getUnitQuizzesByChapter, getUnitQuizBySectionId } from '../../lib/unitQuizzes';
```

**確認**: エラーが発生しないか

#### Phase 2: newChapter1Sectionsの定義
```typescript
const newChapter1Sections = [
  // ...
];
```

**確認**: エラーが発生しないか

#### Phase 3: useEffectの追加
```typescript
useEffect(() => {
  const loadQuizzes = async () => {
    // ...
  };
  loadQuizzes();
}, []);
```

**確認**: エラーが発生しないか

#### Phase 4: HybridContentCardの使用
```typescript
{newChapter1Sections.map((section) => (
  <HybridContentCard
    // ...
  />
))}
```

**確認**: エラーが発生しないか

---

## 🔍 エラー要因の特定

### 考えられるエラー要因

1. **インポートパスの問題**
   - `@/lib/unitQuizzes` → `@/app/lib/unitQuizzes`
   - 相対パスと絶対パスの混在

2. **ファイルの存在確認**
   - `HybridContentCard.tsx`が存在するか
   - `UnitQuizModal.tsx`が存在するか
   - `app/lib/unitQuizzes.ts`が存在するか

3. **型定義の問題**
   - `UnitQuizSection`型が定義されているか
   - 型のインポートが正しいか

4. **データファイルの読み込み**
   - `public/unit_quizzes_all.json`が存在するか
   - パスが正しいか（`/unit_quizzes_all.json`）

5. **Next.jsの設定**
   - `tsconfig.json`のパスエイリアス設定
   - `next.config.mjs`の設定

---

## 📝 チェックリスト

### 古い構造への復元
- [ ] `app/courses/chapter1/page.tsx`を古い構造に戻した
- [ ] 古い構造で動作確認（エラーがない）

### 新しい構造への段階的変更
- [ ] Phase 1: インポートの追加（エラーなし）
- [ ] Phase 2: newChapter1Sectionsの定義（エラーなし）
- [ ] Phase 3: useEffectの追加（エラーなし）
- [ ] Phase 4: HybridContentCardの使用（エラーなし）

### エラー要因の特定
- [ ] どのPhaseでエラーが発生したか記録
- [ ] エラーメッセージを記録
- [ ] エラーの原因を特定

---

**最終更新**: 2025-01-03  
**状態**: 準備完了、段階的な変更を開始


